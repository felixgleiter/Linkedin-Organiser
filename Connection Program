"""CREATE TABLE connections (id INTEGER, first_name TEXT, last_name TEXT, email_address TEXT, company TEXT, position TEXT, connected_on TEXT, tags TEXT);

# Converting the CSV file into an SQL table

SET count = 1
while count <= 5000:
INSERT INTO connections (id, first_name, last_name, email_address, company, position, connected_on, tags) VALUES (count, 'fn', 'ln', 'ea', 'com', 'pos', 'cn', 'ta');
count += 1"""

# Data Lists for Companies, Positions etc.

blattler = {'Daniel ' : 'Blattler', 'Nathalie ' : 'Breuer', 'Mrinal ' : 'Madina', 'David ' : 'Brown', 'Stephan ' : 'Hammes', 'Nina ' : 'Schu'}
Companies = [blattler]
director = {'Daniel ' : 'Blattler'}
project_manager = {'Nathalie ' : 'Breuer', 'Nina ' : 'Schu'}
Positions = [director, project_manager]
  
# Basic Query for the SQL table

def Query():
  
  print "Hello! Please leave any unknown values blank."
  
  Company = raw_input("Company: ").lower()
  
  for c in Companies:
    
    if eval(Company) == c: 
      Position = raw_input("Position: ").lower()
      
      for p in Positions:
        
        if eval(Position) == p:
          Surname = raw_input("Surname: ").lower()
      
          for key in c and p:
      
            if Surname == c[key].lower():
              print key + c[key]
            
            elif Surname == "":
              print key + p[key]

        elif Position == "": #This empty case also doesn't work now!
          Surname = raw_input("Surname: ").lower()
      
          for key in c:
        
            if Surname == c[key].lower():
              print key + c[key]
        
            elif Surname == "":
              print key + c[key]
          
    elif eval(Company) == {}: #Now this empty case doesn't work!
      Position = raw_input("Position: ").lower()
    
      if eval(Position) == p:
        Surname = raw_input("Surname: ").lower()
      
        for key in p:
        
          if Surname == p[key].lower():
            print key + p[key]
          
          elif Surname == "":
            print key + p[key]
            
      elif Position == "": #Empty case doesn't work!
        Surname = raw_input("Surname: ").lower()
      
        for c in Companies:
        
          for key in c:
          
            if Surname == c[key].lower():
              print key + c[key]
            
            elif Surname == "":
              return "I can't help you if you don't give me any information."
          
    elif eval(Company) not in Companies:
      return "I'm afraid I don't know that company. Please restart and try again."

print Query()
